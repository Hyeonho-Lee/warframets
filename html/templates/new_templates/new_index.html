<!DOCTYPE html>
<html lang = "ko">
<html>
    <head>
        <meta charset = "UTF-8">
        <meta name="viewport" content="user-scalable=0, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, width=device-width" />
        <meta http-equiv="Cache-Control" content="no-cache">
        <meta http-equiv="Exprires" content="-1">
        <meta http-equiv="Pragma" content="no-cache">
        <title>Warframe Trade Status (모든 인기 아이템 통계) [테스트]</title>
        <!---------------------------------------------------------------------->
        <link rel="stylesheet" type = "text/css" href = "{{ url_for('static', filename = '/css/new_css/new_index.css', v = 0.1) }}" />
        <script src="{{ url_for('static', filename = '/js/new_js/new_index.js') }}" type="text/javascript"></script>
        <script src="{{ url_for('static', filename = 'js/AutoComplete.min.js') }}" type="text/javascript"></script>
        <script src="{{ url_for('static', filename = 'js/jquery-3.5.1.min.js') }}" type="text/javascript"></script>
        <script src="{{ url_for('static', filename = 'js/jquery-ui.js') }}" type="text/javascript"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    </head>
    <body>
        <script>
            window.onload = function () {
                get_today();
                
                var input = document.getElementById("item_name");
                input.addEventListener('click', function(){
                    var all_items = {{ all_item_kr | tojson }};
                    new AutoComplete(document.querySelector('#item_name'), all_items);
                });
            };
        </script>
        <div class="main">
            <div class="menu">
                <div class="menu_bar">
                    <img alt="" src="{{ url_for('static', filename = '/new_image/index/menu_bar.png', v = 0.1) }}">
                </div>
                <div class="logo">
                    <img alt="" src="{{ url_for('static', filename = '/new_image/index/new_logo.png', v = 0.1) }}">
                </div>
                <div class="language">
                    <img alt="" src="{{ url_for('static', filename = '/new_image/index/kr.png', v = 0.1) }}">
                    <img alt="" src="{{ url_for('static', filename = '/new_image/index/en.png', v = 0.1) }}">
                </div>
            </div>
            <div class="content">
                <div class="date_bar">
                    <div class="day_input" onclick="today_value_open();">
                        <div class="day_menu">
                            <p>Day</p>
                            <img alt="" src="{{ url_for('static', filename = '/new_image/index/menu_bar_1.png', v = 0.1) }}">
                        </div>
                        <div class="day_value">
                            <a class="day_value_1" id="day_value_2"></a>
                            <a class="day_value_2" id="day_value_1"></a>
                        </div>
                    </div>
                    <div class="week_input" onclick="today_value_open();">
                        <div class="week_menu">
                            <p>Week</p>
                            <img alt="" src="{{ url_for('static', filename = '/new_image/index/menu_bar_2.png', v = 0.1) }}">
                        </div>
                        <div class="week_value">
                            <p>rd</p>
                            <a class="week_value_1" id="week_value_2"></a>
                            <a class="week_value_2" id="week_value_1"></a>
                        </div>
                    </div>
                    <div class="month_input" onclick="today_value_open();">
                        <div class="month_menu">
                            <p id="month_char">Month</p>
                            <img alt="" src="{{ url_for('static', filename = '/new_image/index/menu_bar_2.png', v = 0.1) }}">
                        </div>
                        <div class="month_value">
                            <p>th</p>
                            <a class="month_value_1" id="month_value_2"></a>
                            <a class="month_value_2" id="month_value_1"></a>
                        </div>
                    </div>
                </div>
                <div class="search_bar">
                    <div class="control_button" onclick="calender_open();">
                        <img alt="" src="{{ url_for('static', filename = '/new_image/index/search_bar.png', v = 0.1) }}">
                    </div>
                    <div class="search">
                        <input type="text" id="item_name" onkeypress="if(event.keyCode==13) {input_search(); return false;}" placeholder="검색" autocomplete="yes">
                        <img alt="" src="{{ url_for('static', filename = '/new_image/index/search.png', v = 0.1) }}" onclick="input_search()">
                    </div>
                </div>
                <div class="main_bar">
                    <div class="first_menu">
                        <div class="main_top">
                            <div class="main_daily">
                                <a>Daily Search</a>
                                <p id="main_daily"></p>
                            </div>
                            <div class="main_menu" id="menu_button">
                                <ul>
                                    <li id="menu_button_1" value=1 onclick="change_menu_button(value);" class="menu_active">Most Fluctuation Item</li>
                                    <li id="menu_button_2" value=2 onclick="change_menu_button(value);">Daily Top 10</li>
                                    <li id="menu_button_3" value=3 onclick="change_menu_button(value);">Update</li>
                                </ul>
                            </div>
                            <div class="exit_button">
                                <img alt="" src="{{ url_for('static', filename = '/new_image/index/exit.png', v = 0.1) }}" onclick="today_value_exit();">
                            </div>
                        </div>
                        <div class="main_bottom" id="change_menu">
                            <div class="main_recommend">
                                <div class="up" onclick="main_graph_change_1();">
                                    <div class="up_img"><img alt="{{ a_top_kr_name[0] }}" src="{{ url_for('static', filename = a_top_path_1[0], v = 0.1) }}"></div>
                                    <a>{{ a_top_kr_name[0] }}</a>
                                    <span class="up_bottom">
                                        <p>▲</p>
                                        <a>{{ a_top_price[0] }} ({{ a_top_before[0] }}P/{{ a_top_percent[0] }}%)</a>
                                    </span>
                                </div>
                                <div class="down" onclick="main_graph_change_2();">
                                    <div class="down_img"><img alt="{{ a_bottom_kr_name[0] }}" src="{{ url_for('static', filename = a_bottom_path_1[0], v = 0.1) }}"></div>
                                    <a>{{ a_bottom_kr_name[0] }}</a>
                                    <span class="down_bottom">
                                        <p>▼</p>
                                        <a>{{ a_bottom_price[0] }} ({{ a_bottom_before[0] }}P/{{ a_bottom_percent[0] }}%)</a>
                                    </span>
                                </div>
                            </div>
                            <div class="main_graph" id="main_graph">
                                <div style="width:99%;">
                                    <canvas id="canvas" style="height: 48vh; width: 43vw;"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="calender">
                    <div class="cal_exit_button">
                        <img alt="" src="{{ url_for('static', filename = '/new_image/index/exit.png', v = 0.1) }}" onclick="calender_exit();">
                    </div>
                    <div class="cal_header">
                        <div class="cal_head"><a>Daily Search</a></div>
                        <div class="cal_nav">
                            <div class="prev" onclick="prevMonth();"><a>&lt;</a></div>
                            <div class="today" onclick="goToday();"><a>Today</a></div>
                            <div class="c_next" onclick="nextMonth();"><a>&gt;</a></div>
                        </div>
                    </div>
                    <div class="cal_main">
                        <div class="cal_days">
                            <div class="day_sun"><a>Sun</a></div>
                            <div class="day"><a>Mon</a></div>
                            <div class="day"><a>Tue</a></div>
                            <div class="day"><a>Wed</a></div>
                            <div class="day"><a>Thu</a></div>
                            <div class="day"><a>Fri</a></div>
                            <div class="day_sat"><a>Sat</a></div>
                        </div>
                        <div class="dates" id="dates"></div>
                    </div>
                </div>
            </div>
        </div>
        <script>
            var ctx = document.getElementById("canvas");
            var canvas = 'global';
            canvas = new Chart(ctx, {
                type: 'line',
                data:{
                        labels: {{ t_xlabels | tojson }},
                        datasets: [{
                                label: '{{ a_top_kr_name[0] }}',
                                data: {{ t_dataset | tojson }},
                                backgroundColor: 'rgba(255, 99, 132, 0.5)',
                                borderColor: 'rgba(255, 99, 132, 0.5)',
                                fill: 'start',
                                lineTension: 0.3
                            }]
                },
                options: {
                    responsive: false,
                    title: {display: true, text: ''},
                    tooltips: {mode: 'index', intersect: false},
                    hover: {mode: 'nearest', intersect: true},
                    scales: {xAxes: [{display: true, scaleLabel: {display: true}}], yAxes: [{display: true, scaleLabel: {display: true}}]}}
            });
            
            function href_site(click_value){
                var input_item = click_value.getAttribute('value');
                location.href = "/result/" + input_item;
            };
            
            function removeData(chart) {
                chart.data.labels.pop();
                chart.data.datasets.forEach((dataset) => {
                    dataset.data.pop();
                });
                chart.update();
            }
            
            function change_menu_button(button_value){
                var value = button_value;

                var menu_button_1 = document.getElementById("menu_button_1");
                var menu_button_2 = document.getElementById("menu_button_2");
                var menu_button_3 = document.getElementById("menu_button_3");
                var change_menu = document.getElementById("change_menu");

                if (value == 1) {
                    change_menu.innerHTML = "<div class='main_recommend'><div class='up' onclick='main_graph_change_1();'><div class='up_img'><img alt='{{ a_top_kr_name[0] }}'' src='{{ url_for('static', filename = a_top_path_1[0], v = 0.1) }}'></div><a>{{ a_top_kr_name[0] }}</a><span class='up_bottom'><p>▲</p><a>{{ a_top_price[0] }} ({{ a_top_before[0] }}P/{{ a_top_percent[0] }}%)</a></span></div><div class='down' onclick='main_graph_change_2();'><div class='down_img'><img alt='{{ a_bottom_kr_name[0] }}' src='{{ url_for('static', filename = a_bottom_path_1[0], v = 0.1) }}'></div><a>{{ a_bottom_kr_name[0] }}</a><span class='down_bottom'><p>▼</p><a>{{ a_bottom_price[0] }} ({{ a_bottom_before[0] }}P/{{ a_bottom_percent[0] }}%)</a></span></div></div><div class='main_graph' id='main_graph'><div style='width:99%;'><canvas id='canvas' style='height: 48vh; width: 43vw;'></canvas></div></div>";
                    var canvas = new Chart(document.getElementById("canvas"), {
                        type: 'line',
                        data:{
                                labels: {{ t_xlabels | tojson }},
                                datasets: [{
                                        label: '{{ a_top_kr_name[0] }}',
                                        data: {{ t_dataset | tojson }},
                                        backgroundColor: 'rgba(255, 99, 132, 0.5)',
                                        borderColor: 'rgba(255, 99, 132, 0.5)',
                                        fill: 'start',
                                        lineTension: 0.3
                                    }]
                        },
                        options: {
                            responsive: false,
                            title: {display: true, text: ''},
                            scales: {xAxes: [{display: true, scaleLabel: {display: true}}], yAxes: [{display: true, scaleLabel: {display: true}}]
                            }
                        }
                    });
                    
                    menu_button_1.className = "menu_active";
                    menu_button_2.className = "";
                    menu_button_3.className = "";
                }else if (value == 2) {
                    change_menu.innerHTML = "<div class='main_recommend'><div class='top_menubar'><div class='up_menu' onclick='menu_increase();'><a class='up_increase' id='up_increase'>Increase</a></div><div class='down_menu' onclick='menu_decrease();'><a id='down_decrease'>Decrease</a></div></div><div class='down_menubar'><ul id='menu_in_de'>{% for i in range(1,11) %}<li onclick='href_site(this);' value='{{ t_top_kr_name[i - 1] }}'><div class='rank_value'><a>{{ i }}st</a></div><div class='img_box'><img alt='{{ t_top_kr_name[i - 1] }}'src='{{ url_for('static', filename = t_top_path_1[i - 1], v = 0.1) }}'></div><div class='name_value'><a>{{ t_top_kr_name[i -1] }} ({{ t_top_before[i -1] }}P/{{ t_top_percent[i -1] }}%)</a></div></li>{% endfor %}</ul></div></div><div class='main_graph' id='graph_change'><div style='width:99%;'><canvas id='canvas' style='height: 500px; width: 43vw;'></canvas></div></div>";
                    var canvas = new Chart(document.getElementById("canvas"), {
                        type: 'horizontalBar',
                        data:{
                                labels: {{ up_xlabels | tojson }},
                                datasets: [{
                                        label: 'Increase',
                                        data: {{ up_dataset | tojson }},
                                        backgroundColor: 'rgba(255, 99, 132, 0.5)',
                                        borderColor: 'rgba(255, 99, 132, 0.5)',
                                        borderWidth: 1
                                    }]
                        },
                        options: {
                            responsive: false,
                            title: {display: true, text: ''},
                            tooltips: {mode: 'index', intersect: false},
                            hover: {mode: 'nearest', intersect: true},
                            scales: {xAxes: [{display: true, scaleLabel: {display: true}}], yAxes: [{display: true, scaleLabel: {display: true}}]}}
                    });

                    menu_button_1.className = "";
                    menu_button_2.className = "menu_active";
                    menu_button_3.className = "";
                }else if (value == 3) {
                    menu_button_1.className = "";
                    menu_button_2.className = "";
                    menu_button_3.className = "menu_active";
                }else {
                    console.log("error!");
                };
            }
            
            function menu_increase() {
                var change_menu = document.getElementById("menu_in_de");
                var change_graph = document.getElementById("graph_change");
                var up_increase = document.getElementById("up_increase");
                var down_decrease = document.getElementById("down_decrease");
                change_menu.innerHTML = "<ul id='menu_in_de'>{% for i in range(1,11) %}<li onclick='href_site(this);' value='{{ t_top_kr_name[i - 1] }}'><div class='rank_value'><a>{{ i }}st</a></div><div class='img_box'><img alt='{{ t_top_kr_name[i - 1] }}'src='{{ url_for('static', filename = t_top_path_1[i - 1], v = 0.1) }}'></div><div class='name_value'><a>{{ t_top_kr_name[i-1] }} ({{ t_top_before[i -1] }}P/{{ t_top_percent[i-1] }}%)</a></div></li>{% endfor %}";
                change_graph.innerHTML = "<div style='width:99%;'><canvas id='canvas' style='height: 500px; width: 43vw;'></canvas></div>";
                up_increase.className = "up_increase";
                down_decrease.className = "down_menu";
                var canvas = new Chart(document.getElementById("canvas"), {
                    type: 'horizontalBar',
                    data:{
                            labels: {{ up_xlabels | tojson }},
                            datasets: [{
                                    label: 'Increase',
                                    data: {{ up_dataset | tojson }},
                                    backgroundColor: 'rgba(255, 99, 132, 0.5)',
                                    borderColor: 'rgba(255, 99, 132, 0.5)',
                                    borderWidth: 1
                                }]
                    },
                    options: {
                        responsive: false,
                        title: {display: true, text: ''},
                        tooltips: {mode: 'index', intersect: false},
                        hover: {mode: 'nearest', intersect: true},
                        scales: {xAxes: [{display: true, scaleLabel: {display: true}}], yAxes: [{display: true, scaleLabel: {display: true}}]}}
                });
            }
            
            function menu_decrease() {
                var change_menu = document.getElementById("menu_in_de");
                var change_graph = document.getElementById("graph_change");
                var up_increase = document.getElementById("up_increase");
                var down_decrease = document.getElementById("down_decrease");
                change_menu.innerHTML = "<ul id='menu_in_de'>{% for i in range(1,11) %}<li onclick='href_site(this);' value='{{ t_bottom_kr_name[i - 1] }}'><div class='rank_value'><a>{{ i }}st</a></div><div class='img_box'><img alt='{{ t_bottom_kr_name[i - 1] }}'src='{{ url_for('static', filename = t_bottom_path_1[i - 1], v = 0.1) }}'></div><div class='name_value'><a>{{ t_bottom_kr_name[i-1] }} ({{ t_bottom_before[i -1] }}P/{{ t_bottom_percent[i-1] }}%)</a></div></li>{% endfor %}";
                change_graph.innerHTML = "<div style='width:99%;'><canvas id='canvas' style='height: 500px;; width: 43vw;'></canvas></div>";
                up_increase.className = "up_menu";
                down_decrease.className = "down_decrease";
                var canvas = new Chart(document.getElementById("canvas"), {
                    type: 'horizontalBar',
                    data:{
                            labels: {{ down_xlabels | tojson }},
                            datasets: [{
                                    label: 'Decrease',
                                    data: {{ down_dataset | tojson }},
                                    backgroundColor: 'rgba(115, 171, 255, 0.5)',
                                    borderColor: 'rgba(51, 133, 255, 0.5)',
                                    borderWidth: 1
                                }]
                    },
                    options: {
                        responsive: false,
                        title: {display: true, text: ''},
                        tooltips: {mode: 'index', intersect: false},
                        hover: {mode: 'nearest', intersect: true},
                        scales: {xAxes: [{display: true, scaleLabel: {display: true}}], yAxes: [{display: true, scaleLabel: {display: true}}]}}
                });
            }
            
            function main_graph_change_1() {
                var main_graph = document.getElementById("main_graph");
                main_graph.innerHTML = "<canvas id='canvas' style='height: 48vh; width: 43vw;'></canvas>";
                var canvas = new Chart(document.getElementById("canvas"), {
                        type: 'line',
                        data:{
                                labels: {{ t_xlabels | tojson }},
                                datasets: [{
                                        label: '{{ a_top_kr_name[0] }}',
                                        data: {{ t_dataset | tojson }},
                                        backgroundColor: 'rgba(255, 99, 132, 0.5)',
                                        borderColor: 'rgba(255, 99, 132, 0.5)',
                                        fill: 'start',
                                        lineTension: 0.3
                                    }]
                        },
                        options: {
                            responsive: false,
                            title: {display: true, text: ''},
                            scales: {xAxes: [{display: true, scaleLabel: {display: true}}], yAxes: [{display: true, scaleLabel: {display: true}}]
                            }
                        }
                    });
            }
            
            function main_graph_change_2() {
                var main_graph = document.getElementById("main_graph");
                main_graph.innerHTML = "<canvas id='canvas' style='height: 48vh; width: 43vw;'></canvas>";
                var canvas = new Chart(document.getElementById("canvas"), {
                        type: 'line',
                        data:{
                                labels: {{ t_xlabels | tojson }},
                                datasets: [{
                                        label: '{{ a_bottom_kr_name[0] }}',
                                        data: {{ b_dataset | tojson }},
                                        backgroundColor: 'rgba(115, 171, 255, 0.5)',
                                        borderColor: 'rgba(51, 133, 255, 0.5)',
                                        fill: 'start',
                                        lineTension: 0.3
                                    }]
                        },
                        options: {
                            responsive: false,
                            title: {display: true, text: ''},
                            scales: {xAxes: [{display: true, scaleLabel: {display: true}}], yAxes: [{display: true, scaleLabel: {display: true}}]
                            }
                        }
                    });
            }
        </script>
        <div class="footer">
            <div class="footer_content">
                <div class="info">
                    <a>자주묻는질문</a>
                    <a>문의</a>
                    <a>이용약관</a>
                    <a>기여</a>
                </div>
                <div class="icon">
                    <a><img alt="" src="{{ url_for('static', filename = '/new_image/index/discord.png', v = 0.1) }}">Discord</a>
                    <a><img alt="" src="{{ url_for('static', filename = '/new_image/index/patreon.png', v = 0.1) }}">Patreon</a>
                    <a><img alt="" src="{{ url_for('static', filename = '/new_image/index/twitter.png', v = 0.1) }}">Twitter</a>
                </div>
                <div class="ad">
                    광고
                </div>
                <div class="tos">
                    <p>면책조항</p>
                    <a>Digital Extremes Ltd, Warframe and the logo Warframe are registered trademarks. All rights are reserved worldwide. This site has no official link with Digital Extremes Ltd or Warframe. All artwork, screenshots, characters or other recognizable features of the intellectual property relating to these trademarks are likewise the intellectual property of Digital Extremes Ltd.</a>
                </div>
            </div>
        </div>
    </body>
</html>